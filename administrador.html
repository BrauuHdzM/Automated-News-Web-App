<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Administrador</title>
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/FontAwesome.css">
    <link rel="stylesheet" href="/css/Toggle-Switch-toggle-switch.css">
    <link rel="stylesheet" href="/css/Toggle-Switch.css">
    <link rel="stylesheet" href="/css/User-Rating-F19690.css">
    <style>
        .container-fluid {
            width: calc(100% - 40px); 
            margin: 20px; 
        }
        .navbar {
            height: 60px;
            overflow: visible;
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content">
                <nav class="navbar navbar-expand bg-white shadow mb-4 topbar static-top navbar-light">
                    <div class="container-fluid"><button class="btn btn-link d-md-none rounded-circle me-3" id="sidebarToggleTop" type="button"><i class="fas fa-bars"></i></button>
                        <form class="d-none d-sm-inline-block me-auto ms-md-3 my-2 my-md-0 mw-100 navbar-search">
                            <div class="input-group"></div>
                        </form>
                        <ul class="navbar-nav flex-nowrap ms-auto">
                            <div class="d-none d-sm-block topbar-divider"></div>
                            <li class="nav-item dropdown no-arrow">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link" aria-expanded="false" data-bs-toggle="dropdown" href="#"><span class="d-none d-lg-inline me-2 text-gray-600 small">Administrador</span></a>
                                    <div class="dropdown-menu shadow dropdown-menu-end animated--grow-in"><a class="fas fa-sign-out-alt fa-sm fa-fw me-2 text-gray-400" href="/logout"></i>&nbsp;Cerrar sesión</a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
                <div class="container-fluid">
                    <div class="d-sm-flex justify-content-between align-items-center mb-4">
                        <h3 class="text-dark mb-0">Estadísticas generales</h3>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-xl-3 mb-4">
                            <div class="card shadow border-start-primary py-2">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-primary fw-bold text-xs mb-1"><span>Total de usuarios</span></div>
                                            <div id="totalUsuarios" class="text-dark fw-bold h5 mb-0"><span>Número</span></div>
                                        </div>
                                        <div class="col-auto"><i class="fas fa-calendar fa-2x text-gray-300"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-3 mb-4">
                            <div class="card shadow border-start-success py-2">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-success fw-bold text-xs mb-1"><span>Total de artículos</span></div>
                                            <div id="totalArticulos" class="text-dark fw-bold h5 mb-0"><span>Número</span></div>
                                        </div>
                                        <div class="col-auto"><i class="fas fa-dollar-sign fa-2x text-gray-300"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-3 mb-4">
                            <div class="card shadow border-start-info py-2">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-info fw-bold text-xs mb-1"><span>Total de artículos calificados</span></div>
                                            <div class="row g-0 align-items-center">
                                                <div class="col-auto">
                                                    <div id="totalArticulosCalificados" class="text-dark fw-bold h5 mb-0 me-3"><span>Número</span></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-auto"><i class="fas fa-clipboard-list fa-2x text-gray-300"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-xl-3 mb-4">
                            <div class="card shadow border-start-warning py-2">
                                <div class="card-body">
                                    <div class="row align-items-center no-gutters">
                                        <div class="col me-2">
                                            <div class="text-uppercase text-warning fw-bold text-xs mb-1"><span>Calificación promedio</span></div>
                                            <div id="calificacionPromedioGral" class="text-dark fw-bold h5 mb-0"><span>Número</span></div>
                                        </div>
                                        <div class="col-auto"><i class="fas fa-comments fa-2x text-gray-300"></i></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="card shadow mb-4"></div>
                        <div class="d-sm-flex justify-content-between align-items-center mb-4">
                            <h3 class="text-dark mb-0">Promedio de calificaciones por aspecto</h3>
                        </div>
                        <div class="col-lg-3">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="text-primary fw-bold m-0">General</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small fw-bold">Título<span id="promedioTitulo" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionTitulo" class="progress-bar bg-danger" aria-valuenow="1" aria-valuemin="0" aria-valuemax="5" style="width: 20%;"><span class="visually-hidden">20%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Contenido<span id="promedioContenido" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionContenido" class="progress-bar bg-warning" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Redacción<span id="promedioRedaccion" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id= "barraCalificacionRedaccion" class="progress-bar bg-primary" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="text-primary fw-bold m-0">Gemini</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small fw-bold">Título<span id="promedioTituloGemini" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionTituloGemini" class="progress-bar bg-danger" aria-valuenow="1" aria-valuemin="0" aria-valuemax="5" style="width: 20%;"><span class="visually-hidden">20%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Contenido<span id="promedioContenidoGemini" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionContenidoGemini" class="progress-bar bg-warning" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Redacción<span id="promedioRedaccionGemini" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id= "barraCalificacionRedaccionGemini" class="progress-bar bg-primary" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="text-primary fw-bold m-0">GPT 3.5 Base</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small fw-bold">Título<span id="promedioTituloGPTBase" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionTituloGPTBase" class="progress-bar bg-danger" aria-valuenow="1" aria-valuemin="0" aria-valuemax="5" style="width: 20%;"><span class="visually-hidden">20%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Contenido<span id="promedioContenidoGPTBase" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionContenidoGPTBase" class="progress-bar bg-warning" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Redacción<span id="promedioRedaccionGPTBase" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id= "barraCalificacionRedaccionGPTBase" class="progress-bar bg-primary" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="text-primary fw-bold m-0">GPT 3.5 para noticias</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small fw-bold">Título<span id="promedioTituloGPTNoticias" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionTituloGPTNoticias" class="progress-bar bg-danger" aria-valuenow="1" aria-valuemin="0" aria-valuemax="5" style="width: 20%;"><span class="visually-hidden">20%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Contenido<span id="promedioContenidoGPTNoticias" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id="barraCalificacionContenidoGPTNoticias" class="progress-bar bg-warning" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                    <h4 class="small fw-bold">Redacción<span id="promedioRedaccionGPTNoticias" class="float-end">Número</span></h4>
                                    <div class="progress mb-4">
                                        <div id= "barraCalificacionRedaccionGPTNoticias" class="progress-bar bg-primary" aria-valuenow="2" aria-valuemin="0" aria-valuemax="5" style="width: 40%;"><span class="visually-hidden">40%</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>                 
                    </div>
                    <div class="row">
                        <div class="card shadow mb-4">
                        </div>
                        <div class="col-lg-12">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="text-primary fw-bold m-0">Últimos artículos</h6>
                                </div>
                                <ul class="list-group list-group-flush" id="latestArticlesList">
                                    <!-- Los artículos se insertarán aquí -->
                                </ul>
                            </div>
                        </div> 
                    </div>
                </div>
            </div>
            <footer class="bg-white sticky-footer">
                <div class="container my-auto">
                    <div class="text-center my-auto copyright"><span>Generador de noticias</span></div>
                </div>
            </footer>
        </div>
    </div>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/startup-modern.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            fetch('/api/estadisticas')
            .then(response => response.json())
            .then(data => {
                document.getElementById('totalUsuarios').innerText = data.totalUsuarios;
                document.getElementById('totalArticulos').innerText = data.totalArticulos;
                document.getElementById('totalArticulosCalificados').innerText = data.totalCalificaciones;
                document.getElementById('calificacionPromedioGral').innerText = data.promedioCalificacionGral;
                document.getElementById('promedioTitulo').innerText = data.promedioCalificacionTitulo;
                document.getElementById('promedioContenido').innerText = data.promedioCalificacionContenido;
                document.getElementById('promedioRedaccion').innerText = data.promedioCalificacionRedaccion;
                document.getElementById('barraCalificacionTitulo').style.width = data.promedioCalificacionTitulo * 100 / 5 + '%';
                document.getElementById('barraCalificacionContenido').style.width = data.promedioCalificacionContenido * 100 / 5 + '%';
                document.getElementById('barraCalificacionRedaccion').style.width = data.promedioCalificacionRedaccion * 100 / 5 + '%';
                document.getElementById('barraCalificacionTituloGemini').style.width = data.promedioCalificacionTituloGemini * 100 / 5 + '%';
                document.getElementById('barraCalificacionContenidoGemini').style.width = data.promedioCalificacionContenidoGemini * 100 / 5 + '%';
                document.getElementById('barraCalificacionRedaccionGemini').style.width = data.promedioCalificacionRedaccionGemini * 100 / 5 + '%';
                document.getElementById('barraCalificacionTituloGPTBase').style.width = data.promedioCalificacionTituloGPT35Base * 100 / 5 + '%';
                document.getElementById('barraCalificacionContenidoGPTBase').style.width = data.promedioCalificacionContenidoGPT35Base * 100 / 5 + '%';
                document.getElementById('barraCalificacionRedaccionGPTBase').style.width = data.promedioCalificacionRedaccionGPT35Base * 100 / 5 + '%';
                document.getElementById('barraCalificacionTituloGPTNoticias').style.width = data.promedioCalificacionTituloGPT35News * 100 / 5 + '%';
                document.getElementById('barraCalificacionContenidoGPTNoticias').style.width = data.promedioCalificacionContenidoGPT35News * 100 / 5 + '%';
                document.getElementById('barraCalificacionRedaccionGPTNoticias').style.width = data.promedioCalificacionRedaccionGPT35News * 100 / 5 + '%';
                document.getElementById('promedioTituloGemini').innerText = data.promedioCalificacionTituloGemini;
                document.getElementById('promedioContenidoGemini').innerText = data.promedioCalificacionContenidoGemini;
                document.getElementById('promedioRedaccionGemini').innerText = data.promedioCalificacionRedaccionGemini;
                document.getElementById('promedioTituloGPTBase').innerText = data.promedioCalificacionTituloGPT35Base;
                document.getElementById('promedioContenidoGPTBase').innerText = data.promedioCalificacionContenidoGPT35Base;
                document.getElementById('promedioRedaccionGPTBase').innerText = data.promedioCalificacionRedaccionGPT35Base;
                document.getElementById('promedioTituloGPTNoticias').innerText = data.promedioCalificacionTituloGPT35News;
                document.getElementById('promedioContenidoGPTNoticias').innerText = data.promedioCalificacionContenidoGPT35News;
                document.getElementById('promedioRedaccionGPTNoticias').innerText = data.promedioCalificacionRedaccionGPT35News;
                const listaUltimosArticulos = document.getElementById('latestArticlesList');
                const articulos = data.ultimosArticulos;
                listaUltimosArticulos.innerHTML = '';
                articulos.forEach(articulo => {
                    const listItem = document.createElement("li");
                    listItem.classList.add("list-group-item");
                    listItem.innerHTML = `
                        <div class="row align-items-center no-gutters">
                            <div class="col me-2">
                                <h6 class="mb-0"><strong>${articulo.titulo}</strong></h6>
                                <span class="text-xs">${articulo.fecha}</span>
                            </div>
                        </div>
                        `;
                    listaUltimosArticulos.appendChild(listItem);
                });
            })  
            .catch(error => {
                console.error('Error:', error);
            });
        })
    </script>

</body>

</html>